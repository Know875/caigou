#!/bin/bash

echo "=========================================="
echo "检查 CPU 使用情况"
echo "=========================================="
echo ""

echo "📊 1. CPU 使用率最高的进程（前 15 个）"
echo "----------------------------------------"
ps aux --sort=-%cpu | head -n 15

echo ""
echo "📊 2. 系统负载详情"
echo "----------------------------------------"
uptime

echo ""
echo "📊 3. 内存使用情况"
echo "----------------------------------------"
free -h

echo ""
echo "📊 4. 检查是否有异常进程"
echo "----------------------------------------"
ps aux | grep -E "fghgf|health.sh|rondo|89.144.31.18|80.64.16.241|205.185.126.196" | grep -v grep || echo "✓ 无恶意进程"

echo ""
echo "📊 5. 检查 PM2 服务状态"
echo "----------------------------------------"
pm2 status

echo ""
echo "=========================================="
echo "检查完成"
echo "=========================================="
echo ""
echo "💡 提示："
echo "- 系统负载是过去 1、5、15 分钟的平均值，需要时间下降"
echo "- 如果 CPU 使用率仍然很高，检查是否有正常的高负载进程"
echo "- 建议等待 5-10 分钟，观察负载是否继续下降"

