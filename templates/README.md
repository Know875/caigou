# 📋 文件导入模板说明

本目录包含两种导入功能的模板文件。

## 📁 模板文件

### 1. 商品导入模板 (`import-products-template.csv`)

用于**导入商品并创建询价单**功能。

**支持的格式**: CSV、Excel (.xlsx, .xls)

**表头字段说明**（按顺序排列）:

模板表头中已标注了 **(必填)** 和 **(可选)** 标识，方便识别：

- **订单号(可选)** - 关联的订单编号
- **订单时间(可选)** - 订单日期（格式：YYYY-MM-DD 或 YYYY-MM-DD HH:mm:ss）
- **货名(必填)** - 商品名称（必须填写）
- **数量(必填)** - 商品数量，必须是整数（必须填写）
- **单位(可选)** - 计量单位，如：个、件、套、箱等
- **价格(可选)** - 商品价格/订单金额
- **最高限价(可选)** - 供应商报价不能超过此价格
- **一口价(可选)** - 供应商报价≤此价格时自动中标
- **收件人(可选)** - 收货人姓名（有订单号时建议填写）
- **手机号(可选)** - 收货人手机号码（有订单号时建议填写）
- **地址(可选)** - 收货地址（有订单号时建议填写）
- **修改地址(可选)** - 修改后的地址（如有）
- **openid(可选)** - 用户微信 openid（有订单号时建议填写）
- **用户昵称(可选)** - 用户昵称
- **描述(可选)** - 商品详细描述
- **备注(可选)** - 其他备注信息
- **积分(可选)** - 使用的积分数量

**注意**: 表头中的 **(必填)** 和 **(可选)** 标识仅用于说明，实际导入时系统会根据字段名（去掉括号部分）进行匹配。

**使用步骤**:
1. 打开 `import-products-template.csv` 文件
2. 删除示例数据行（保留表头）
3. 填入您的商品数据
4. 保存为 CSV 或 Excel 格式
5. 在系统中选择"导入商品并创建询价单"功能上传文件

**注意事项**:
- 第一行必须是表头，字段名必须与模板一致
- **货名**和**数量**是必填字段，不能为空
- 数量必须是正整数
- 如果填写了**订单号**，建议同时填写**收件人**、**手机号**、**地址**等订单信息，系统会自动创建订单记录
- 订单相关字段（收件人、手机号、地址等）都是可选的，但如果填写了订单号，建议填写完整订单信息
- 文件编码建议使用 UTF-8

---

### 2. 历史订单导入模板 (`import-history-orders-template.csv`)

用于**导入历史订单数据**功能。

**支持的格式**: CSV、Excel (.xlsx, .xls)

**表头字段说明**:

模板表头中已标注了 **(必填)** 和 **(可选)** 标识，方便识别：

- **发货编号(可选)** - 发货单编号
- **订单号(可选)** - 订单编号
- **open_id(可选)** - 用户微信 openid
- **收件人(可选)** - 收货人姓名
- **手机号(可选)** - 收货人手机号码
- **地址(可选)** - 收货地址
- **修改地址(可选)** - 修改后的地址（如有）
- **货名(必填)** - 商品名称（必须填写）
- **数量(必填)** - 商品数量（必须填写）
- **机台标价(可选)** - 商品标价（金额）
- **积分(可选)** - 使用的积分数量
- **状态(可选)** - 订单状态（如：已发货、待发货、已完成等）
- **日期(可选)** - 订单日期（格式：YYYY-MM-DD 或 YYYY-MM-DD HH:mm:ss）
- **备注(可选)** - 备注信息
- **快递单号(可选)** - 物流单号
- **成本价(可选)** - 商品成本价（金额）

**注意**: 表头中的 **(必填)** 和 **(可选)** 标识仅用于说明，实际导入时系统会根据字段名（去掉括号部分）进行匹配。

**使用步骤**:
1. 打开 `import-history-orders-template.csv` 文件
2. 删除示例数据行（保留表头）
3. 填入您的历史订单数据
4. 保存为 CSV 或 Excel 格式
5. 在系统中选择"导入历史数据"功能上传文件

**注意事项**:
- 第一行必须是表头，字段名必须与模板一致
- 日期格式建议使用：`YYYY-MM-DD` 或 `YYYY-MM-DD HH:mm:ss`
- 金额字段（机台标价、成本价）使用数字格式，不要包含货币符号
- 文件编码建议使用 UTF-8
- 导入前请确保已选择对应的门店

---

## 📝 通用使用说明

### Excel 格式要求

1. **表头位置**: 第一行必须是表头
2. **数据格式**:
   - 日期：使用标准日期格式（YYYY-MM-DD）
   - 数字：使用数字格式，不要包含千分位符号
   - 文本：使用文本格式
3. **空值处理**: 可选字段可以留空，但不要删除整列
4. **编码**: 保存时选择 UTF-8 编码（CSV 文件）

### 常见问题

**Q: 导入失败，提示"文件格式错误"？**
A: 请检查：
- 表头是否在第一行
- 表头字段名是否与模板完全一致（包括中英文、空格）
- 文件编码是否为 UTF-8
- 文件格式是否为 CSV、XLSX 或 XLS

**Q: 导入后部分数据缺失？**
A: 请检查：
- 必填字段是否都已填写
- 数据格式是否正确（如数量必须是整数）
- 是否有特殊字符导致解析错误

**Q: 日期格式不正确？**
A: 建议使用以下格式之一：
- `2025-01-21`
- `2025-01-21 10:30:00`
- Excel 日期格式（Excel 会自动识别）

**Q: 金额字段导入错误？**
A: 请确保：
- 金额字段只包含数字和小数点
- 不要包含货币符号（¥、$等）
- 不要包含千分位符号（,）

---

## 🔗 相关功能

- **导入商品并创建询价单**: 在询价单创建页面使用
- **导入历史订单数据**: 在订单管理 > 历史导入页面使用

---

**最后更新**: 2025-01-21

